<!DOCTYPE html>
<html class="header-dark">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Wich libraries are vulnerable to attacks and how to prevent them.">
    
    <meta name="keywords" content="featured, jwt, alg, security, authentication, crypto">
    

    <!-- <meta property="fb:admins" content="YOUR_FB_USER_ID" /> -->
<meta property="fb:app_id" content="534074790006350"/>
<meta property="og:title" content="Critical vulnerabilities in JSON Web Token libraries" />
<meta property="og:site_name" content="Auth0 - Blog" />
<meta property="og:url" content="https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" />

<meta name="og:image" content="https://cldup.com/MNjkZFJXXK.png">



<meta property="og:description" content="Wich libraries are vulnerable to attacks and how to prevent them." />



<meta property="og:type" content="article">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">

<meta name="twitter:image" content="https://cldup.com/MNjkZFJXXK.png">

<meta name="twitter:title" content="Critical vulnerabilities in JSON Web Token libraries">
<meta name="twitter:description" content="Wich libraries are vulnerable to attacks and how to prevent them.">
<meta name="twitter:creator" content="@auth0">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">


    <title>Critical vulnerabilities in JSON Web Token libraries</title>

    <script src="//use.typekit.net/tde2fii.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript" src="//cdn.auth0.com/js/lock-6.min.js"></script>
    <script type="text/javascript" src="//cdn.auth0.com/web-header/latest/standalone.min.js"></script>
    <link rel="stylesheet" href="//cdn.auth0.com/web-header/latest/standalone.min.css" />

    

    

    
    <link rel="canonical" href="/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" />
    

    <link rel="shortcut icon" href="//cdn.auth0.com/styleguide/latest/lib/logos/img/favicon.png">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/auth0">
    <link type="application/opensearchdescription+xml" rel="search" href="/osd.xml"/>

    <link href="//cdn.auth0.com/styleguide/latest/index.css" rel="stylesheet">

    <link rel="stylesheet" href="/blog/css/index.css" />

    <script type="text/javascript">
      var segmentKey =  'WqErZyd56ob3pmMDnko55hNgFt8B4Zox' ;
      !function(){var analytics=window.analytics=window.analytics||[];if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.0";
        analytics.load(segmentKey);
        analytics.page();
      }}();
    </script>
</head>
<body>
    
<!-- Facebook -->
<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=534074790006350&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<!-- Twitter -->
<script type="text/javascript">
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script>

<!-- Google+ -->
<!--
<script type="text/javascript">
  (function() {
    var po = document.createElement('script');
    po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
  })();
</script>
-->


    <header class="site-header clearfix">
    </header>
    <script type="text/javascript">
      (function() {
        var header = new WebHeader({ base_url: 'https://auth0.com' });
        header.render('header.site-header');
      })();
    </script>

    
    <!-- Twitter Conversion -->
<script src="//platform.twitter.com/oct.js" type="text/javascript"></script>
<script type="text/javascript">
  twttr.conversion.trackPid('l4rua');
</script>

<noscript>
  <img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=l4rua&p_id=Twitter" />
  <img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?txn_id=l4rua&p_id=Twitter" />
</noscript>






<div class="banner banner-post" style="background: #1B231C">
    <div class="container banner-container">
        <i class="icon-budicon-697 hide"></i>

        <h1><a href="/blog/">Blog</a></h1>

        












  <a href="/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" 
    style="
 
  background: none;
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
 
  
 
  
 
  
"
    src="https://cldup.com/MNjkZFJXXK.png"
    alt="Critical vulnerabilities in JSON Web Token libraries">
  </a>


        <h2 class="entry-title"><a href="/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" title="Published: March 31, 2015">Critical vulnerabilities in JSON Web Token libraries</a></h2>

        
        <div class="entry-content">
          <p>Wich libraries are vulnerable to attacks and how to prevent them.</p>

        </div>
        

        <div class="post-info">
          <div class="author">
            <a href="https://timmclean.net"><img src="https://www.gravatar.com/avatar/dfea5c5f769cc4a6cce74d3eda20bba3?size=200" width="27" height="27"> <span class="name">Tim McLean</span></a>
          </div>

          <div class="date">
            <time datetime="March 31, 2015" class="published updated">March 31, 2015</time>
          </div>

          <div class="social-stats">
  <a href="#" data-url="https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" data-type="twitter" data-count="true" class="network">
    
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

    <path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

      c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

      c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

      c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

      C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

      C436.339,160.061,450.668,145.174,462,128.223z"/>

    </svg>

  </a>

  <a href="#" data-url="https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" data-type="linkedin" data-count="true" class="network">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

    <path id="linkedin-icon" d="M411.945,50h-312c-27.614,0-50,22.386-50,50v312c0,27.614,22.386,50,50,50h312

      c27.614,0,50-22.386,50-50V100C461.945,72.386,439.56,50,411.945,50z M180.996,392.99h-56.537V210.336h56.537V392.99z

       M152.457,186.417c-18.465,0-33.432-15.09-33.432-33.703c0-18.614,14.967-33.704,33.432-33.704c18.463,0,33.432,15.09,33.432,33.704

      C185.889,171.327,170.92,186.417,152.457,186.417z M392.865,392.99h-56.262c0,0,0-69.582,0-95.881

      c0-26.296-9.988-40.974-30.781-40.974c-22.629,0-34.453,15.289-34.453,40.974c0,28.133,0,95.881,0,95.881h-54.223V210.336h54.223

      v24.599c0,0,16.309-30.171,55.041-30.171s66.455,23.648,66.455,72.572C392.865,326.262,392.865,392.99,392.865,392.99z"/>

    </svg>
  </a>

  <a href="#" data-url="https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/" data-type="facebook" data-count="true" class="network">
    <svg width="17" height="17" viewBox="0 0 412 412" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
      <g id="facebook-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
          <path d="M283.80119,412 L361.995375,412 C389.611494,412 412,389.612167 412,361.995375 L412,50.0046252 C412,22.3885058 389.612167,0 361.995375,0 L50.0046252,0 C22.3885058,0 0,22.3878333 0,50.0046252 L0,361.995375 C0,389.611494 22.3878333,412 50.0046252,412 L219.907783,412 L219.907783,254.137637 L166.482996,254.137637 L166.482996,192.266054 L219.907783,192.266054 L219.907783,146.637452 C219.907783,93.6867027 252.247398,64.8530656 299.484232,64.8530656 C322.110827,64.8530656 341.559134,66.5376524 347.225329,67.2916602 L347.225329,122.6301 L314.462578,122.644417 C288.775412,122.644417 283.80119,134.851707 283.80119,152.764958 L283.80119,192.266054 L345.068293,192.266054 L337.089173,254.137637 L283.80119,254.137637 L283.80119,412 Z" id="Rectangle-1" fill="#000000" sketch:type="MSShapeGroup"></path>
      </g>
    </svg>
  </a>
</div>
        </div>

    </div>
</div>

<div id="container" class="container">
    <div class="blog-post blog-single">
        <div class="inner">
            <div class="entry-content" >
            <blockquote><p>tl;dr If you are using <a href="https://github.com/auth0/node-jsonwebtoken">node-jsonwebtoken</a>, <a href="https://github.com/jpadilla/pyjwt/">pyjwt</a>, <a href="https://github.com/namshi/jose">namshi/jose</a>, <a href="https://github.com/firebase/php-jwt">php-jwt</a> or <a href="https://github.com/kjur/jsjws">jsjwt</a> with asymmetric keys (RS256, RS384, RS512, ES256, ES384, ES512) please update to the latest version. See <a href="http://jwt.io">jwt.io</a> for more information on the vulnerable libraries. <em>(Updated 2015-04-20)</em></p>

<p>This is a guest post from Tim McLean, who is part of the <a href="https://auth0.com/whitehat#hall-of-fame">Auth0 Security Researcher Hall of Fame</a>. Tim normally blogs at <a href="https://www.timmclean.net">www.timmclean.net</a>.</p></blockquote>

<p>Recently, while reviewing the security of various JSON Web Token
implementations, I found many libraries with critical vulnerabilities allowing
attackers to bypass the verification step.  The same two flaws were found
across many implementations and languages, so I thought it would be helpful to
write up exactly where the problems occur.  I believe that a change to the
standard could help prevent future vulnerabilities.</p>

<!-- more -->


<p>For those who are unfamiliar, JSON Web Token (JWT) is a standard for creating
tokens that assert some number of claims.  For example, a server could generate
a token that has the claim "logged in as admin" and provide that to a client.
The client could then use that token to prove that they are logged in as admin.
The tokens are signed by the server's key, so the server is able to verify that
the token is legitimate.</p>

<p>JWTs generally have three parts: a header, a payload, and a signature.  The
header identifies which algorithm is used to generate the signature, and looks
something like this:</p>

<pre><code>header = '{"alg":"HS256","typ":"JWT"}'
</code></pre>

<p><code>HS256</code> indicates that this token is signed using HMAC-SHA256.</p>

<p>The payload contains the claims that we wish to make:</p>

<pre><code>payload = '{"loggedInAs":"admin","iat":1422779638}'
</code></pre>

<p>As suggested in the JWT spec, we include a timestamp called <code>iat</code>, short for
"issued at".</p>

<p>The signature is calculated by base64url encoding the header and payload and
concatenating them with a period as a separator:</p>

<pre><code>key = 'secretkey'
unsignedToken = encodeBase64(header) + '.' + encodeBase64(payload)
signature = HMAC-SHA256(key, unsignedToken)
</code></pre>

<p>To put it all together, we base64url encode the signature, and join together
the three parts using periods:</p>

<pre><code>token = encodeBase64(header) + '.' + encodeBase64(payload) + '.' + encodeBase64(signature)

# token is now:
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dnZWRJbkFzIjoiYWRtaW4iLCJpYXQiOjE0MjI3Nzk2Mzh9.gzSraSYS8EXBxLN_oWnFSRgCzcmJmMjLiuyu5CSpyHI
</code></pre>

<h2>Great.  So, what's wrong with that?</h2>

<p>Well, let's try to verify a token.</p>

<p>First, we need to determine what algorithm was used to generate the
signature.  No problem, there's an <code>alg</code> field in the header that tells us just
that.</p>

<p>But wait, we haven't validated this token yet, which means that we haven't
validated the header.  This puts us in an awkward position: in order to
validate the token, we have to allow attackers to select which method we use to
verify the signature.</p>

<p>This has disastrous implications for some implementations.</p>

<h2>Meet the "none" algorithm</h2>

<p>The <code>none</code> algorithm is a curious addition to JWT.  It is intended to be used
for situations where the integrity of the token has already been verified.
Interestingly enough, it is one of only two algorithms that are mandatory to
implement (the other being <code>HS256</code>).</p>

<p>Unfortunately, some libraries treated tokens signed with the <code>none</code> algorithm
as a valid token with a verified signature.  The result?  Anyone can create
their own "signed" tokens with whatever payload they want, allowing arbitrary
account access on some systems.</p>

<p>Putting together such a token is easy.  Modify the above example header to
contain <code>"alg": "none"</code> instead of <code>HS256</code>.  Make any desired changes to the
payload.  Use an empty signature (i.e. <code>signature = ""</code>).</p>

<p>Most (hopefully all?) implementations now have a basic check to prevent this
attack: if a secret key was provided, then token verification will fail for
tokens using the <code>none</code> algorithm.  This is a good idea, but it doesn't solve
the underlying problem: attackers control the choice of algorithm.  Let's keep
digging.</p>

<h2>RSA or HMAC?</h2>

<p>The JWT spec also defines a number of asymmetric signing algorithms (based on
RSA and ECDSA).  With these algorithms, tokens are created and signed using a
private key, but verified using a corresponding public key.  This is pretty
neat: if you publish the public key but keep the private key to yourself, only
you can sign tokens, but anyone can check if a given token is correctly signed.</p>

<p>Most of the JWT libraries that I've looked at have an API like this:</p>

<pre><code># sometimes called "decode"
verify(string token, string verificationKey)
# returns payload if valid token, else throws an error
</code></pre>

<p>In systems using HMAC signatures, <code>verificationKey</code> will be the server's secret
signing key (since HMAC uses the same key for signing and verifying):</p>

<pre><code>verify(clientToken, serverHMACSecretKey)
</code></pre>

<p>In systems using an asymmetric algorithm, <code>verificationKey</code> will be the public
key against which the token should be verified:</p>

<pre><code>verify(clientToken, serverRSAPublicKey)
</code></pre>

<p>Unfortunately, an attacker can abuse this.  If a server is expecting a token
signed with RSA, but actually receives a token signed with HMAC, <strong>it will
think the public key is actually an HMAC secret key</strong>.</p>

<p>How is this a disaster?  HMAC secret keys are supposed to be kept private,
while public keys are, well, public.  This means that your typical <a href="https://i.imgur.com/18fM5ja.jpg">ski
mask-wearing attacker</a> has access to the
public key, and can use this to forge a token that the server will accept.</p>

<p>Doing so is pretty straightforward.  First, grab your favourite JWT library,
and choose a payload for your token.  Then, get the public key used on the
server as a verification key (most likely in the text-based PEM format).
Finally, sign your token using the PEM-formatted public key as an HMAC key.
Essentially:</p>

<pre><code>forgedToken = sign(tokenPayload, 'HS256', serverRSAPublicKey)
</code></pre>

<p>The trickiest part is making sure that <code>serverRSAPublicKey</code> is identical to the
verification key used on the server.  The strings must match exactly for the
attack to work -- exact same format, and no extra or missing line breaks.</p>

<p>End result?  Anyone with knowledge of the public key can forge tokens that will
pass verification.</p>

<h2>Recommendations for Library Developers</h2>

<p>I suggest that JWT libraries add an <code>algorithm</code> parameter to their verification function:</p>

<pre><code>verify(string token, string algorithm, string verificationKey)
</code></pre>

<p>The server should already know what algorithm it uses to sign tokens, and it's
not safe to allow attackers to provide this value.</p>

<p>Some might argue that some servers need to support more than one algorithm for
compatibility reasons.  In this case, a separate key can (and should) be used
for each supported algorithm.  JWT conveniently provides a "key ID" field
(<code>kid</code>) for exactly this purpose.  Since servers can use the key ID to look up
the key and its corresponding algorithm, attackers are no longer able to
control the manner in which a key is used for verification.  In any case, I
don't think JWT libraries should even look at the <code>alg</code> field in the header,
except maybe to check that it matches what was the expected algorithm.</p>

<p>Anyone using a JWT implementation should make sure that tokens with a different
signature type are guaranteed to be rejected.  Some libraries have an optional
mechanism for whitelisting or blacklisting algorithms; take advantage of it or
you might end up at risk.  Even better: have a policy of performing security
audits on any open source libraries that you use to provide mission-critical
funtionality.</p>

<h2>Improving the JWT/JWS standard</h2>

<p>I would like to propose deprecating the header's <code>alg</code> field.  As we've seen
here, its misuse can have a devastating impact on the security of a JWT/JWS
implementation.  As far as I can tell, key IDs provide an adequate alternative.
This warrants a change to the spec: JWT libraries continue to be written with
security flaws due to their dependence on <code>alg</code>.</p>

<p>JWT (and JOSE) present the opportunity to have a cross-platform suite of secure
cryptography implementations.  With these fixes, hopefully we're a little bit
closer to making that a reality.</p>

            </div>

            

            <div class="try-banner">
                <span>Try Auth0 for FREE</span>
                <a href="javascript:signup()" class="signup-button btn btn-success btn-lg">Create free Account</a>
            </div>

            

<p class="small-caps text-center">Recent Posts</p>

<div class="related-posts">

  

  

  <div class="entry-related">
    












  <a href="/blog/2015/05/04/design-at-auth0/" 
    style="
 
  background: #222229;
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
 
  
  max-width: 170%;
  
 
  
  top: 52%;
  
 
  
"
    src="http://assets.auth0.com/blog/design-process/badge.png"
    alt="Engineering the Design Process at Auth0">
  </a>


    <h2 class="entry-title"><a href="/blog/2015/05/04/design-at-auth0/" title="Published: May 04, 2015">Engineering the Design Process at Auth0</a></h2>
  </div>

  

  

  <div class="entry-related">
    












  <a href="/blog/2015/04/28/announcing-auth0-sso-dashboard/" 
    style="
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
  opacity: 0.8;
  
 
  
  max-width: 200%;
  
 
  
 
  
"
    src="https://cloudup.com/cfENOYpKxfL+"
    alt="Announcing the Auth0 Open Source Single-Sign-On Dashboard">
  </a>


    <h2 class="entry-title"><a href="/blog/2015/04/28/announcing-auth0-sso-dashboard/" title="Published: April 28, 2015">Announcing the Auth0 Open Source Single-Sign-On Dashboard</a></h2>
  </div>

  

  

  <div class="entry-related">
    












  <a href="/blog/2015/04/27/auth0-europe-launches/" 
    style="
 
 
 
"
    class="entry-thumbnail">
    <img 
    style="
  
 
  
  max-width: 155%;
  
 
  
 
  
"
    src="https://cldup.com/C76gL6oGIE.png"
    alt="Auth0 Europe Launches">
  </a>


    <h2 class="entry-title"><a href="/blog/2015/04/27/auth0-europe-launches/" title="Published: April 27, 2015">Auth0 Europe Launches</a></h2>
  </div>

</div>

            <div id="disqus_thread">
            </div>
        </div>
    </div>
    <br />
</div>

<g:plusone annotation="inline"></g:plusone>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'auth0blog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    <div class="container">
      <footer class="site-footer clearfix">
        <div class="logo"><img src=
        "https://cdn.auth0.com/styleguide/1.0.0/img/badge.png" width="30"></div>

        <div class="footer-grid">
          <div class="column">
            <div class="item">
              <h6>Product</h6>
            </div>

            <div class="item">
              <a href="/pricing">Pricing</a>
            </div>

            <div class="item">
              <a href="/why-auth0">Why Auth0</a>
            </div>

            <div class="item">
              <a href="/how-it-works">How It Works</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Company</h6>
            </div>

            <div class="item">
              <a href="/about">About Us</a>
            </div>

            <div class="item">
              <a href="/blog">Blog</a>
            </div>

            <div class="item">
              <a href="/jobs">Jobs</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Security</h6>
            </div>

            <div class="item">
              <a href="/availability-trust">Availability &amp; Trust</a>
            </div>

            <div class="item">
              <a href="/security">Security</a>
            </div>

            <div class="item">
              <a href="/whitehat">White Hat</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Learn</h6>
            </div>

            <div class="item">
              <a href="/support">Help &amp; Support</a>
            </div>

            <div class="item">
              <a href="https://auth0.com/docs">Documentation</a>
            </div>

            <div class="item">
              <a href="/opensource">Open Source</a>
            </div>
          </div>

          <div class="column">
            <div class="item">
              <h6>Extend</h6>
            </div>

            <div class="item">
              <a href="/lock">Lock</a>
            </div>

            <div class="item">
              <a href="/wordpress">Wordpress</a>
            </div>

            <div class="item">
              <a href="https://auth0.com/docs/apiv2">API Explorer</a>
            </div>
          </div>

          <div class="contact">
            <div class="column">
              <div class="item">
                <h6>Contact</h6>
              </div>

              <div class="item">
                <a href="mailto:support@auth0.com">Email Us</a>
              </div>

              <div class="item">
                10777 Main Street<br>
                Suite 204<br>
                Bellevue, WA 98004
              </div>
            </div>

            <div class="column no-heading">
              <div class="item">
                <a href="tel:+18882352699">+1 (888) 235-2699</a>
              </div>

              <div class="item">
                <a href="tel:+14253126521">+1 (425) 312-6521</a>
              </div>
            </div>
          </div>
        </div>

        <div class="colophon">
          <div class="column">
            <div class="social">
              <div class="twitter">
                <iframe class="twitter" frameborder="0" scrolling="no" src=
                "//platform.twitter.com/widgets/follow_button.html?screen_name=auth0">
                </iframe>
              </div>

              <div class="facebook">
                <iframe class="facebook" frameborder="0" scrolling="no" src=
                "//www.facebook.com/plugins/like.php?href=https%3A%2F%2Ffacebook.com%2Fgetauth0&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;show_count=false&amp;share=false&amp;height=21&amp;appId=507756515938786">
                </iframe>
              </div>
            </div>
          </div>

          <div class="column">
            <ul class="list-inline text-right">
              <li>
                <a href="/privacy">Privacy Policy</a>
              </li>

              <li>
                <a href="/terms">Terms of Service</a>
              </li>

              <li><span>Â© 2013-2015 Auth0 All Rights Reserved</span></li>
            </ul>
          </div>
        </div>
      </footer>
    </div>



    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="/blog/js/vendor/moment.min.js"></script>
    <script src="/blog/js/vendor/jquery.csbuttons.min.js"></script>
    <script type="text/javascript">
      (function () {
        var lock = window.lock = new Auth0Lock('zEYfpoFzUMEzilhkHilcWoNkrFfJ3hAI', 'auth0.auth0.com');
        var options = {
          callbackURL:    'https://manage.auth0.com/callback',
          dict: {
            signup: {
              footerText: 'By signing up, you agree to our <a href="/terms" target="_new">terms of service</a> and <a href="/privacy" target="_new">privacy policy</a>'
            }
          },
          icon: '//cdn.auth0.com/styleguide/latest/lib/logos/img/badge.png'
        };

        function getBasicInfo () {
          return {
            path: window.location.pathname,
            url: window.location.toString(),
            title: document.title,
            referrer: document.referrer,
            category: 'Lock',
            label: 'blog'
          }
        }

        lock.on('signup ready', function () {
          if (!window.analytics) return;
          window.analytics.track('open:signup', getBasicInfo());
        });

        lock.on('signin ready', function () {
          if (!window.analytics) return;
          window.analytics.track('open:signin', getBasicInfo());
        });

        lock.getClient().getSSOData(false, function (err, data) {
          if (!data || !data.sso) return;
          $('.login')
            .attr('href', 'https://manage.auth0.com')
            .html('Open Dashboard');
        });

        window.login = function login() {
          if (window.analytics) {
            window.analytics.track('click:signin', getBasicInfo());
          }
          lock.hide(function() {
            lock.show(options);
          });
        }

        window.signup = function() {
          if (window.analytics) {
            window.analytics.track('click:signup', getBasicInfo());
          }
          lock.hide(function() {
            lock.showSignup(options);
          });
        }
      })()
      
      $(function() {
        // Social Buttons
        $('.social-stats .network').cSButtons();

        // prettyPrint
        $('pre').addClass("prettyprint");

        // Force al content links to blank
        $('.entry-content a').each(function() {
          $(this).attr('target', '_blank');
        });

        $('.post-info time').each(function() {
          var $current = $(this);
          var dateString = $current.text();
          var diff = moment(dateString).diff(moment(new Date()), 'days');
          var dateFormat;

          dateFormat = moment(dateString).fromNow();

          if(diff > -10) {
            $current.text(dateFormat);
          }

          $current.addClass('rendered');
        });
      });

      $.fn.isOnScreen = function(){
        var win = $(window);
        var viewport = {
          top : win.scrollTop(),
          left : win.scrollLeft()
        };
        viewport.right = viewport.left + win.width();
        viewport.bottom = viewport.top + win.height();

        var bounds = win.offset();
        if (!bounds) return;

        bounds.right = bounds.left + win.outerWidth();
        bounds.bottom = bounds.top + win.outerHeight();

        return (!(viewport.right < bounds.left || viewport.left > bounds.right || viewport.bottom < bounds.top || viewport.top > bounds.bottom));
      };
    </script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'auth0blog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>
